<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <title>导出</title>
    <link rel="stylesheet" href="../../../renderer/remixicon-local.css" />
    <style>
      * { box-sizing: border-box; }
      html, body { margin:0; padding:0; background:#1f1f1f; color:#e6e6e6; font-family: system-ui, Arial, sans-serif; overflow:hidden; }
      .wrap { padding: 10px; width: 240px; }
      .title { font-weight:600; margin-bottom:8px; display:flex; align-items:center; gap:8px; }
      .menu { display:flex; flex-direction:column; gap:6px; }
      button { background:#222; color:#e6e6e6; border:1px solid #2c2c2c; border-radius:8px; padding:6px 10px; text-align:left; cursor:pointer; font-size:13px; }
      button:hover { background:#2a2a2a; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="title"><i class="ri-download-2-line"></i><span>导出</span></div>
      <div class="menu">
        <button id="expImg"><i class="ri-image-line"></i> 导出为图片</button>
        <button id="expDoc"><i class="ri-file-word-line"></i> 生成 Word 文件</button>
      </div>
    </div>
    <script>
      const CH='multiword.lowbar';
      document.getElementById('expImg').addEventListener('click', () => {
        try { window.lowbarAPI.emitEvent(CH, { type:'control', action:'export', cmd:'image' }); } catch {}
        try { window.lowbarAPI.emitEvent(CH, { type:'update', target:'floatingUrl', value: null }); } catch {}
      });
      document.getElementById('expDoc').addEventListener('click', () => {
        try { window.lowbarAPI.emitEvent(CH, { type:'control', action:'export', cmd:'word' }); } catch {}
        try { window.lowbarAPI.emitEvent(CH, { type:'update', target:'floatingUrl', value: null }); } catch {}
      });
    </script>
  </body>
  </html>
